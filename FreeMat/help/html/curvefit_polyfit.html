<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<HTML>
<HEAD>
<TITLE>POLYFIT Fit Polynomial To Data
</TITLE>
</HEAD>
<BODY>
<H2>POLYFIT Fit Polynomial To Data
</H2>
<P>
Section: <A HREF=sec_curvefit.html> Optimization and Curve Fitting </A>
<H3>Usage</H3>
The <code>polyfit</code> routine has the following syntax
<PRE>
  p = polyfit(x,y,n)
</PRE>
<P>
where <code>x</code> and <code>y</code> are vectors of the same size, and
<code>n</code> is the degree of the approximating polynomial.  
The resulting vector <code>p</code> forms the coefficients of
the optimal polynomial (in descending degree) that fit
<code>y</code> with <code>x</code>.  
<H3>Function Internals</H3>
The <code>polyfit</code> routine finds the approximating polynomial
<P>
<DIV ALIGN="CENTER">
<IMG SRC="polyfit_eqn1.png">
</DIV>
<P>
such that
<P>
<DIV ALIGN="CENTER">
<IMG SRC="polyfit_eqn2.png">
</DIV>
<P>
is minimized.  It does so by forming the Vandermonde matrix
and solving the resulting set of equations using the backslash
operator.  Note that the Vandermonde matrix can become poorly
conditioned with large <code>n</code> quite rapidly.
<H3>Example</H3>
A classic example from Edwards and Penny, consider the problem
of approximating a sinusoid with a polynomial.  We start with
a vector of points evenly spaced on the unit interval, along with
a vector of the sine of these points.
<PRE>
--&gt; x = linspace(0,1,20);
--&gt; y = sin(2*pi*x);
--&gt; plot(x,y,'r-')
</PRE>
The resulting plot is shown here
<P>
<DIV ALIGN="CENTER">
<IMG SRC="polyfit1.png">
</DIV>
<P>
Next, we fit a third degree polynomial to the sine, and use
<code>polyval</code> to plot it
<PRE>
--&gt; p = polyfit(x,y,3)

p = 
   21.9170  -32.8756   11.1897   -0.1156 

--&gt; f = polyval(p,x);
--&gt; plot(x,y,'r-',x,f,'ko');
</PRE>
The resulting plot is shown here
<P>
<DIV ALIGN="CENTER">
<IMG SRC="polyfit2.png">
</DIV>
<P>
Increasing the order improves the fit, as
<PRE>
--&gt; p = polyfit(x,y,11)

p = 

 Columns 1 to 9

   12.4644  -68.5541  130.0555  -71.0940  -38.2814  -14.1222   85.1018   -0.5642  -41.2861 

 Columns 10 to 12

   -0.0029    6.2832   -0.0000 

--&gt; f = polyval(p,x);
--&gt; plot(x,y,'r-',x,f,'ko');
</PRE>
The resulting plot is shown here
<P>
<DIV ALIGN="CENTER">
<IMG SRC="polyfit3.png">
</DIV>
<P>
</BODY>
</HTML>
