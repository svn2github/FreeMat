<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<HTML>
<HEAD>
<TITLE>ATAN2 Inverse Trigonometric 4-Quadrant Arctangent Function
</TITLE>
</HEAD>
<BODY>
<H2>ATAN2 Inverse Trigonometric 4-Quadrant Arctangent Function
</H2>
<P>
Section: <A HREF=sec_mathfunctions.html> Mathematical Functions </A>
<H3>Usage</H3>
Computes the <code>atan2</code> function for its argument.  The general
syntax for its use is
<PRE>
  z = atan2(y,x)
</PRE>
<P>
where <code>x</code> and <code>y</code> are <code>n</code>-dimensional arrays of numerical type.
Integer types are promoted to the <code>double</code> type prior to
calculation of the <code>atan2</code> function. The size of the output depends
on the size of <code>x</code> and <code>y</code>.  If <code>x</code> is a scalar, then <code>z</code>
is the same size as <code>y</code>, and if <code>y</code> is a scalar, then <code>z</code>
is the same size as <code>x</code>.  The type of the output is equal to the type of
|y/x|.  
<H3>Function Internals</H3>
The function is defined (for real values) to return an 
angle between <code>-pi</code> and <code>pi</code>.  The signs of <code>x</code> and <code>y</code>
are used to find the correct quadrant for the solution.  For complex
arguments, the two-argument arctangent is computed via
<P>
<DIV ALIGN="CENTER">
<IMG SRC="atan2_eqn1.png">
</DIV>
<P>
For real valued arguments <code>x,y</code>, the function is computed directly using 
the standard C library's numerical <code>atan2</code> function. For both 
real and complex arguments <code>x</code>, note that generally
<P>
<DIV ALIGN="CENTER">
<IMG SRC="atan2_eqn2.png">
</DIV>
<P>
due to the periodicities of  <code>cos(x)</code> and <code>sin(x)</code>.
<H3>Example</H3>
The following code demonstates the difference between the <code>atan2</code> 
function and the <code>atan</code> function over the range <code>[-pi,pi]</code>.
<PRE>
--&gt; x = linspace(-pi,pi);
--&gt; sx = sin(x); cx = cos(x);
--&gt; plot(x,atan(sx./cx),x,atan2(sx,cx))
</PRE>
<P>
<DIV ALIGN="CENTER">
<IMG SRC="atan2plot.png">
</DIV>
<P>
Note how the two-argument <code>atan2</code> function (green line) 
correctly ``unwraps'' the phase of the angle, while the <code>atan</code> 
function (red line) wraps the angle to the interval <code>[-\pi/2,\pi/2]</code>.
</BODY>
</HTML>
