<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<HTML>
<HEAD>
<TITLE>ODE45 Numerical Solution of ODEs
</TITLE>
</HEAD>
<BODY>
<H2>ODE45 Numerical Solution of ODEs
</H2>
<P>
Section: <A HREF=sec_num.html> Numerical Methods </A>
<H3>Usage</H3>
 function [t,y] = ode45(f,tspan,y0,options,varargin)
 function SOL   = ode45(f,tspan,y0,options,varargin)
<P>
 ode45 is a solver for ordinary differential equations and initial value problems.
 To solve the ODE
<PRE>
      y'(t) =  f(t,y)
      y(0)  =  y0
</PRE>
<P>
 over the interval tspan=[t0 t1], you can use ode45. For example, to solve
 the ode
<P>
      y'   =  y
      y(0) =  1
<P>
 whose exact solution is y(t)=exp(t), over the interval t0=0, t1=3, do
<PRE>
--&gt;       [t,y]=ode45(@(t,y) y,[0 3],1)
Warning: Newly defined variable error shadows a function of the same name.  Use clear error to recover access to the function
t = 

 Columns 1 to 9

         0    0.0030    0.0180    0.0930    0.3930    0.6930    0.9930    1.2930    1.5930 

 Columns 10 to 14

    1.8930    2.1930    2.4930    2.7930    3.0000 

y = 
    1.0000 
    1.0030 
    1.0182 
    1.0975 
    1.4814 
    1.9997 
    2.6993 
    3.6437 
    4.9185 
    6.6392 
    8.9620 
   12.0975 
   16.3299 
   20.0854 
</PRE>
 If you want a dense output (i.e., an output that also contains an interpolating
 spline), use instead
<PRE>
--&gt;       SOL=ode45(@(t,y) y,[0 3],1)
Warning: Newly defined variable error shadows a function of the same name.  Use clear error to recover access to the function

SOL = 
    x: 1x14 double array
    y: 1x14 double array
    xe: 
    ye: 
    ie: 
    solver: generic_ode_solver
    interpolant: 1x1 functionpointer array
    idata: 1x1 struct array
</PRE>
 You can view the result using
<PRE>
      plot(0:0.01:3,deval(SOL,0:0.01:3))
</PRE>
<P>
 You will notice that this function is available for "every" value of t, while
<P>
      plot(t,y,'o-')
<P>
 is only available at a few points.
<P>
 The optional argument 'options' is a structure. It may contain any of the
 following fields:
<P>
 'AbsTol'      - Absolute tolerance, default is 1e-6.
 'RelTol'      - Relative tolerance, default is 1e-3.
 'MaxStep'     - Maximum step size, default is (tspan(2)-tspan(1))/10
 'InitialStep' - Initial step size, default is maxstep/100
 'Stepper'     - To override the default Fehlberg integrator
 'Events'      - To provide an event function
 'Projection'  - To provide a projection function
<P>
 The varargin is ignored by this function, but is passed to all your callbacks, i.e.,
 f, the event function and the projection function.
<P>
 ==Event Function==
<P>
 The event function can be used to detect situations where the integrator should stop,
 possibly because the right-hand-side has changed, because of a collision, etc...
<P>
 An event function should look like
<P>
    function [val,isterminal,direction]=event(t,y,...)
<P>
 The return values are:
<P>
 val        - the value of the event function.
 isterminal - whether or not this event should cause termination of the integrator.
 direction  - 1=upcrossings only matter, -1=downcrossings only, 0=both.
<P>
 == Projection function ==
<P>
 For geometric integration, you can provide a projection function which will be
 called after each time step. The projection function has the following signature:
<P>
     function yn=project(t,yn,...);
<P>
 If the output yn is very different from the input yn, the quality of interpolation
 may decrease.
</BODY>
</HTML>
